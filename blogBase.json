{"singlePage": [], "startSite": "", "filingNum": "", "onePageListNum": 20, "commentLabelColor": "#006b75", "yearColorList": ["#bc4c00", "#0969da", "#1f883d", "#A333D0"], "i18n": "CN", "themeMode": "manual", "dayTheme": "light_tritanopia", "nightTheme": "dark_tritanopia", "urlMode": "pinyin", "script": "", "style": "", "head": "", "indexScript": "", "indexStyle": "", "bottomText": "", "showPostSource": 1, "iconList": {}, "UTC": 8, "rssSplit": "sentence", "exlink": {}, "needComment": 1, "allHead": "", "title": "Kylin's", "subTitle": "Essay", "avatarUrl": "https://avatars.githubusercontent.com/u/45586871?v=4", "GMEEK_VERSION": "last", "postListJson": {"P2": {"htmlDir": "docs/post/zai- Rust-zhong- -dong-tai-lian-jie-he-yun-xing-shi-jia-zai-dong-tai-ku.html", "labels": ["rust"], "postTitle": "\u5728 Rust\u4e2d \u52a8\u6001\u94fe\u63a5\u548c\u8fd0\u884c\u65f6\u52a0\u8f7d\u52a8\u6001\u5e93", "postUrl": "post/zai-%20Rust-zhong-%20-dong-tai-lian-jie-he-yun-xing-shi-jia-zai-dong-tai-ku.html", "postSourceUrl": "https://github.com/kylinholmes/kylinholmes.github.io/issues/2", "commentNum": 0, "wordCount": 2338, "description": "## \u52a8\u6001\u94fe\u63a5crate\r\n\r\n**\u5047\u8bbe\u52a8\u6001\u5e93\u662f impls**\r\n**\u9700\u8981\u94fe\u63a5\u5230 impls\u7684crate\u662fabi**\r\n\r\n```bash\r\n\u251c\u2500\u2500 abi                     # runtime loading library\r\n\u2502  \u251c\u2500\u2500 Cargo.toml           # specifies dependent libraries to be used for dynamic linking\r\n\u2502  \u2514\u2500\u2500 src\r\n\u2502     \u251c\u2500\u2500 import.rs         # import impls to this crate\r\n\u2502     \u251c\u2500\u2500 lib.rs            # \r\n\u2502     \u2514\u2500\u2500 main.rs           # test main: loading abi and binding interface\r\n\u251c\u2500\u2500 impls                   # dynamic link library \r\n\u2502  \u2514\u2500\u2500 src\r\n\u2502     \u2514\u2500\u2500 lib.rs            # impls\r\n\u2514\u2500\u2500 README.md\r\n```\r\n\r\n`main` == loadl ibrary => `abi` == dynamic link ==> `impls`\r\n\r\n\u8bbe\u7f6elib\u7c7b\u578b\u4e3a`cdylib`\r\n```toml\r\n# impls/Cargo.toml\r\n[lib]\r\ncrate-type = ['cdylib']\r\n```\r\n\r\n\u5bfc\u51fa\u63a5\u53e3\r\n```rust\r\n// impls/src/lib.rs\r\n#[no_mangle]\r\npub extern 'C' fn add(left: usize, right: usize) -> usize {\r\n    left + right\r\n}\r\n```\r\n\r\n\r\n\r\n\u8bbe\u7f6e\u4f9d\u8d56 \r\n```toml\r\n# abi/Cargo.toml\r\n[dependencies]\r\nimpls = { path = '../impls' }\r\n```\r\n\r\n\u63a5\u53e3\u5b9a\u4e49\r\n```rust\r\n#[link(name = 'impls')]\r\nextern 'C' {\r\n    pub fn add(a :usize, b: usize) -> usize;\r\n}\r\n```\r\n\r\n\u8c03\u7528\u63a5\u53e3\r\n```rust\r\nprintln!('Add {}', add(1, 9));\r\n```\r\n\r\n## \u8fd0\u884c\u65f6\u52a0\u8f7d\u52a8\u6001\u5e93\r\n\u56e0\u4e3a\u662f\u8fd0\u884c\u65f6\u52a0\u8f7d\uff0c\u6240\u4ee5\u51fd\u6570\u7684\u63a5\u53e3\u4e0d\u9700\u8981\u5355\u72ec\u5b9a\u4e49\uff0c\u901a\u5e38\u662f\u7ed1\u5b9a\u5230\u51fd\u6570\u6307\u9488\u4e0a\r\n\r\n```toml\r\n# abi/Cargo.toml\r\n[dependencies]\r\nimpls = { path = '../impls' }\r\nlibloading = '0.8.5'\r\n```\r\n\r\n```rust\r\n// abi/src/main.rs\r\nuse libloading::{Library, Symbol};\r\n\r\nstatic DLL_HANDLE:Lazy<Library> = Lazy::new(|| {\r\n    unsafe {\r\n        let dll = std::env::args().nth(1).expect('No DLL provided');\r\n        Library::new(dll).expect('Failed to load DLL')\r\n    }\r\n});\r\n\r\n// \u5b9a\u4e49\u597d\u51fd\u6570\u6307\u9488\u7684\u7ed3\u6784\u4f53\r\n#[derive(Debug)]\r\nstruct Interface<'a> {\r\n    add: Symbol<'a, extern 'C' fn(usize, usize) -> usize>,\r\n    init: Symbol<'a, extern 'C' fn() -> ()>,\r\n}\r\n\r\n// \u52a0\u8f7d\u52a8\u6001\u5e93\u540e\uff0c\u7ed1\u5b9a\u51fd\u6570\u6307\u9488\r\nimpl <'a> Interface<'a> {\r\n    fn new() -> Self {\r\n        unsafe {\r\n            let add: Symbol<extern 'C' fn(usize, usize) -> usize> = DLL_HANDLE.borrow().get(b'add').expect('Failed to load add');\r\n            let init: Symbol<extern 'C' fn() -> ()> = DLL_HANDLE.borrow().get(b'init').expect('Failed to load init');\r\n            Interface {\r\n                add,\r\n                init\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfn main() {\r\n    let handle = Interface::new();\r\n    (handle.init)();\r\n    let result = (handle.add)(1, 9);\r\n    println!('Result: {}', result);\r\n    \r\n}\r\n\r\n```\r\n\r\n\r\n## Demo\r\n\u9879\u76ee\u5730\u5740 [Demo](https://github.com/kylinholmes/rs_dynamic_link)\u3002", "top": 0, "createdAt": 1723438079, "style": "", "script": "", "head": "", "ogImage": "https://avatars.githubusercontent.com/u/45586871?v=4", "createdDate": "2024-08-12", "dateLabelColor": "#bc4c00"}, "P3": {"htmlDir": "docs/post/Application Binary Interface.html", "labels": ["Basic"], "postTitle": "Application Binary Interface", "postUrl": "post/Application%20Binary%20Interface.html", "postSourceUrl": "https://github.com/kylinholmes/kylinholmes.github.io/issues/3", "commentNum": 0, "wordCount": 658, "description": "\r\n**ABI \u5927\u81f4\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9**\r\n~~Todo: ~~\r\n- [ ] \u51fd\u6570\u8c03\u7528\uff1a\r\n- [ ] \u6570\u636e\u7c7b\u578b\u5e03\u5c40\uff1a\r\n- [ ] \u5f02\u5e38\u5904\u7406\uff1a\r\n- [ ] \u5185\u5b58\u7ba1\u7406\uff1a\r\n- [ ] \u547d\u540d\u91cd\u6574\uff08Name Mangling\uff09\uff1a\r\n- [ ] \u7c7b\u578b\u8f6c\u6362\uff1a\r\n- [ ] \u7ebf\u7a0b\u673a\u5236\uff1a\r\n- [ ] \u52a8\u6001\u94fe\u63a5\uff1a\r\n\r\n \r\n## \u51fd\u6570\u8c03\u7528\r\n  - \u53c2\u6570\u4f20\u9012\uff1a\u89c4\u5b9a\u4e86\u51fd\u6570\u53c2\u6570\u662f\u5982\u4f55\u4f20\u9012\u7684\uff0c\u5305\u62ec\u53c2\u6570\u7684\u987a\u5e8f\u3001\u4f4d\u7f6e\uff08\u5bc4\u5b58\u5668\u6216\u6808\uff09\u7b49\u3002", "top": 0, "createdAt": 1724384786, "style": "", "script": "", "head": "", "ogImage": "https://avatars.githubusercontent.com/u/45586871?v=4", "createdDate": "2024-08-23", "dateLabelColor": "#bc4c00"}, "P4": {"htmlDir": "docs/post/bu-yao-zai-shi-yong-CentOS-xi-de-fa-xing-ban- -zuo-wei-yun-xing-he-kai-fa-huan-jing.html", "labels": ["Basic", "Misc"], "postTitle": "\u4e0d\u8981\u518d\u4f7f\u7528CentOS\u7cfb\u7684\u53d1\u884c\u7248 \u4f5c\u4e3a\u8fd0\u884c\u548c\u5f00\u53d1\u73af\u5883", "postUrl": "post/bu-yao-zai-shi-yong-CentOS-xi-de-fa-xing-ban-%20-zuo-wei-yun-xing-he-kai-fa-huan-jing.html", "postSourceUrl": "https://github.com/kylinholmes/kylinholmes.github.io/issues/4", "commentNum": 0, "wordCount": 462, "description": "## CentOS\u672c\u8eab\u4e0d\u518d\u7ef4\u62a4\r\n\u56e0\u4e3a\u4e0d\u518d\u7ef4\u62a4\uff0c\u90e8\u5206\u955c\u50cf\u6e90\u4ed3\u5e93\uff08\u6e05\u534e\u6e90\uff09 \u5f00\u59cb\u505c\u6b62\u670d\u52a1\u3002", "top": 0, "createdAt": 1726034787, "style": "", "script": "", "head": "", "ogImage": "https://avatars.githubusercontent.com/u/45586871?v=4", "createdDate": "2024-09-11", "dateLabelColor": "#bc4c00"}, "P5": {"htmlDir": "docs/post/Native -he- Uniapp-de- -shuang-xiang-tong-xin.html", "labels": ["Uniapp"], "postTitle": "Native \u548c Uniapp\u7684 \u53cc\u5411\u901a\u4fe1", "postUrl": "post/Native%20-he-%20Uniapp-de-%20-shuang-xiang-tong-xin.html", "postSourceUrl": "https://github.com/kylinholmes/kylinholmes.github.io/issues/5", "commentNum": 0, "wordCount": 2063, "description": "\u4e3b\u8981\u601d\u8def\uff1a\r\n1. FFI\uff1a \u901a\u8fc7ABI\u63a5\u53e3\u628a\u6570\u636e\u4f20\u8f93\u5230 Uniapp\r\n2. \u76f4\u63a5\u901a\u8fc7\u53d1\u9001\u6d88\u606f\u7684\u63a5\u53e3\u53d1\u9001\u6570\u636e\r\n\r\n\u5176\u4e2d1\u5728\u5b89\u5353\u7684\u63a5\u53e3\u4e2d\u662f\u786e\u5b9e\u652f\u6301\u7684\uff0c\u5728IOS\u4e2d\u6682\u65f6\u6ca1\u770b\u5230\u76f8\u5173\u63a5\u53e3\r\nAndroid: [DCUniMPJSCallback.invoke(data)](https://nativesupport.dcloud.net.cn/UniMPDocs/API/android-v2.html#dcunimpjscallback-invoke)\r\n\r\n**\u8003\u8651\u5230\u7edf\u4e00\uff0c\u53ef\u4ee5\u8003\u8651\u7528\u65b9\u68482\uff0c\u901a\u8fc7\u53d1\u9001event**\r\n\r\n## Native\u5230 Uniapp\r\n> \u5bbf\u4e3b\u4e3b\u52a8\u89e6\u53d1\u4e8b\u4ef6\u5230\u6b63\u5728\u8fd0\u884c\u7684\u5c0f\u7a0b\u5e8f\u3002", "top": 0, "createdAt": 1730994798, "style": "", "script": "", "head": "", "ogImage": "https://avatars.githubusercontent.com/u/45586871?v=4", "createdDate": "2024-11-07", "dateLabelColor": "#bc4c00"}}, "singeListJson": {}, "labelColorDict": {"Basic": "#2C00DF", "documentation": "#0075ca", "Misc": "#FEC383", "rust": "#DA545B", "Uniapp": "#6ED9D1"}, "displayTitle": "Kylin's", "faviconUrl": "https://avatars.githubusercontent.com/u/45586871?v=4", "ogImage": "https://avatars.githubusercontent.com/u/45586871?v=4", "primerCSS": "<link href='https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/Primer/21.0.7/primer.css' rel='stylesheet' />", "homeUrl": "https://kylinholmes.github.io", "prevUrl": "disabled", "nextUrl": "disabled"}